<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <!-- Bootstrap CSS -->
    <link rel="stylesheet" href="/libs/Bootstrap/bootstrap.min.css">
    <!-- Google Fonts -->
    <!-- <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link
        href="https://fonts.googleapis.com/css2?family=Poppins:ital,wght@0,100;0,200;0,300;0,400;0,500;0,600;0,700;0,800;0,900;1,100;1,200;1,300;1,400;1,500;1,600;1,700;1,800;1,900&display=swap"
        rel="stylesheet"> -->
    <link rel="stylesheet" href="/libs/noUiSlider/nouislider.css">
    <!-- Custom CSS -->
    <link rel="stylesheet" href="/css/loginStyle/login.css">
    <link rel="stylesheet" href="/css/signUpStyle/signup.css">
    <link rel="stylesheet" href="/css/signUpStyle/signup2.css">
    <link rel="stylesheet" href="/css/signUpStyle/signup3.css">
    <link rel="stylesheet" href="/css/font.css">
    <link rel="stylesheet" href="/css/listPlaceStyle/listPlace.css">
    <title>RoomyCo</title>
</head>



<body>
    <main>
        <section class="main-page">
            <div class="page-container row mx-0 p-0">
                <!-- Branding Section -->
                <div class="branding-section p-md-5 p-sm-3 col-3">
                    <div class="branding-header">
                        <img class="logo me-3" src="/images/loginPage/loginLogo.svg" alt="RoomyCo Logo">
                        <h5 class="text-uppercase poppins-bold">RoomyCo <span class="poppins-light">ROOMMATE</span>
                        </h5>
                    </div>
                    <div class="branding-body">
                        <p class="branding-text poppins-light text-start mb-5 pb-5">Tell us more
                            about you</p>
                    </div>

                    <!-- Step Indicator Section -->

                </div>

                <!-- Form Section -->
                <div class="col-9 pe-lg-5 text-md-center form-section">
                    <div class="steps-indicator ">
                        <div class="step-circle done poppins-light" id="step1"
                            onclick="loadPage('./signupFirstScreen.html')">1
                        </div>
                        <div class="step-circle done poppins-light" id="step2"
                            onclick="loadPage('./signupSecondScreen.html')">2
                        </div>
                        <div class="step-circle active poppins-light" id="step3"
                            onclick="loadPage('./signupThirdScreen.html')">
                            3</div>
                    </div>
                    <form action="./screens/Home/home.html" id="signup3-form" novalidate=""
                        class="page-form d-flex flex-column gap-3 ps-md-5 pe-2 ms-5 needs-validation w-50">


                        <div class="d-flex flex-row justify-content-start align-items-evenly gap-2">
                            <div class="col-auto me-md-5 d-flex justify-content-center align-items-center">
                                <label for="originCountry" class="form-label">i am looking for</label>
                            </div>
                            <div class="col-4">
                                <select required="" id="originCountry"
                                    class="form-select custom-select poppins-light  p-3">
                                    <option value="" disabled="">Origin</option>
                                    <option value="">syria</option>

                                </select>
                                <div class="valid-feedback">
                                    look good
                                </div>
                                <div class="invalid-feedback">
                                    Please select a valid Origin.
                                </div>
                            </div>
                        </div>



                        <div class="price-slider">
                            <h5>Price range</h5>
                            <span class="text-muted">Monthly prices before fees and taxes</span>
                            <div class="histogram-container">
                                <canvas class="w-100" id="priceHistogram"></canvas>
                            </div>

                            <!-- Price Range Slider -->
                            <div class="slider-container">
                                <div id="priceSlider"></div>
                            </div>
                        </div>

                        <!-- Min and Max Price Inputs -->

                        <div class="input-container">
                            <label for="minPriceInput">Min Price:</label>
                            <input class="form-control input-group input-group-sm w-50 me-4" type="number"
                                id="minPriceInput" min="100" max="500" value="100">
                            <label for="maxPriceInput">Max Price:</label>
                            <input class="form-control input-group input-group-sm w-50 me-4"="number" id="maxPriceInput"
                                min="100" max="500" value="500">
                        </div>

                        <div class="row justify-content-center align-items-center">
                            <label class="form-label col-8 mb-0">Count of people prefer to live with</label>
                            <div class="d-flex align-items-center col-4 qty ">
                                <span class="d-flex justify-content-center align-items-center minus me-3">-</span>
                                <input type="number" class="count Poppins-medium" name="qty" value="1" min="1">
                                <span class="d-flex justify-content-center align-items-center plus ms-3">+</span>
                            </div>
                        </div>
                        <div class="row justify-content-center align-items-center">
                            <label class="form-label col-8 mb-0">Count of people living with you</label>
                            <div class="d-flex align-items-center col-4 qty ">
                                <span class="d-flex justify-content-center align-items-center minus me-3">-</span>
                                <input type="number" class="count Poppins-medium" name="qty" value="1" min="1">
                                <span class="d-flex justify-content-center align-items-center plus ms-3">+</span>
                            </div>
                        </div>


                        <div class="row ">
                            <label class="col-6 form-label mb-3">Do you prefer any pets?</label>
                            <div class="col-6">
                                <input type="checkbox" id="petsToggle" class="toggleCheckbox ">
                                <label for="petsToggle" class="toggleContainer w-75">
                                    <div class="poppins-light">Yes</div>
                                    <div class="poppins-light">No</div>
                                </label>
                            </div>
                        </div>
                        <div class="row">
                            <label class="col-6 form-label">Do you smoke?</label>
                            <div class="col-6">
                                <input type="checkbox" id="smokeToggle" class="toggleCheckbox ">
                                <label for="smokeToggle" class="toggleContainer w-75">
                                    <div class="poppins-light">Yes</div>
                                    <div class="poppins-light">No</div>
                                </label>
                            </div>
                        </div>


                        <div class="row ">
                            <div class="button-container d-flex justify-content-center">
                                <button type="submit"
                                    class="fw-normal btn sign-in-button d-flex justify-content-evenly w-100 py-3">
                                    Next
                                </button>
                            </div>
                        </div>
                    </form>

                </div>
            </div>
        </section>
    </main>


    <!-- JavaScript Files -->
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.6.0/jquery.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/noUiSlider/15.8.1/nouislider.min.js"
        integrity="sha512-g/feAizmeiVKSwvfW0Xk3ZHZqv5Zs8PEXEBKzL15pM0SevEvoX8eJ4yFWbqakvRj7vtw1Q97bLzEpG2IVWX0Mg=="
        crossorigin="anonymous" referrerpolicy="no-referrer"></script>
    <!-- validating form -->
    <script>
        // Example starter JavaScript for disabling form submissions if there are invalid fields
        (function () {
            'use strict'

            // Fetch all the forms we want to apply custom Bootstrap validation styles to
            var forms = document.querySelectorAll('.needs-validation')

            // Loop over them and prevent submission
            Array.prototype.slice.call(forms)
                .forEach(function (form) {
                    form.addEventListener('submit', function (event) {
                        if (!form.checkValidity()) {
                            event.preventDefault()
                            event.stopPropagation()
                        }

                        form.classList.add('was-validated')
                    }, false)
                })
        })()
    </script>
    <!-- function to get the toggle buttons values  -->
    <script>
        const smoketoggleCheckbox = document.getElementById('smokeToggle');

        // Function to get the current value
        function getToggleValue() {
            return smoketoggleCheckbox.checked ? 'No' : 'Yes';
        }

        // Example usage: listen to change event
        smoketoggleCheckbox.addEventListener('change', () => {
            const value = getToggleValue();
            console.log("smokeToggle Toggle value:", value); // This will print "Yes" or "No"
        });

        const petstoggleCheckbox = document.getElementById('petsToggle');

        // Function to get the current value
        function getToggleValue2() {
            return petstoggleCheckbox.checked ? 'No' : 'Yes';
        }

        // Example usage: listen to change event
        petstoggleCheckbox.addEventListener('change', () => {
            const value = getToggleValue2();
            console.log("pets Toggle value:", value); // This will print "Yes" or "No"
        });

    </script>
    <!-- 
    script for adding the days and months for every year as option without adding it manually 
    -->
    <script>
        $(document).ready(function () {
            var $daySelect = $('#day');
            var $monthSelect = $('#month');
            var $yearSelect = $('#year');

            var startYear = 1960;
            var endYear = new Date().getFullYear();

            // Populate years
            for (var year = endYear; year >= startYear; year--) {
                $('<option>').val(year).text(year).appendTo($yearSelect);
            }

            // Function to populate days based on month and year
            function updateDays() {
                var month = parseInt($monthSelect.val(), 10);
                var year = parseInt($yearSelect.val(), 10);

                $daySelect.empty().append('<option value="" disabled>Day</option>'); // Clear previous days

                if (month && year) {
                    var daysInMonth = new Date(year, month, 0).getDate(); // Get the number of days in the selected month and year

                    for (var day = 1; day <= daysInMonth; day++) {
                        $('<option>').val(day).text(day).appendTo($daySelect);
                    }
                }
            }

            // Event listeners to update days when month or year changes
            $monthSelect.change(updateDays);
            $yearSelect.change(updateDays);

            // Initial population of days
            updateDays();
        });

    </script>
    <!-- 
        script for saving the form data to populate it later when visiting the page again 
         -->
    <script>
        document.addEventListener('change', (event) => {
            const form = event.target.closest('form');
            if (form && form.id) {
                saveData(form.id);
            }
        });

        document.addEventListener('submit', (event) => {
            const form = event.target.closest('form');
            if (form && form.id) {
                saveData(form.id);
            }
        });

    </script>
    <script>
        const priceHistogramCanvas = document.getElementById('priceHistogram');
        const ctx = priceHistogramCanvas.getContext('2d');

        // Initialize the slider
        const priceSlider = document.getElementById('priceSlider');

        noUiSlider.create(priceSlider, {
            start: [100, 500],
            connect: true,
            range: {
                'min': 100,
                'max': 500
            },
            step: 1,
            tooltips: false, // Disable tooltips
        });

        // Generate data with a normal distribution
        function generateNormalData(count, mean, stdDev, minValue, maxValue) {
            const data = [];
            for (let i = 0; i < count; i++) {
                let value;
                do {
                    // Generate a normal distribution value
                    const u1 = Math.random();
                    const u2 = Math.random();
                    const z = Math.sqrt(-2 * Math.log(u1)) * Math.cos(2 * Math.PI * u2);
                    value = mean + z * stdDev;
                } while (value < minValue || value > maxValue);

                data.push(value);
            }
            return data;
        }

        // Create 42 bins
        const binCount = 42;
        const minValue = 100;
        const maxValue = 500;
        const mean = 300; // Mean for normal distribution
        const stdDev = 70; // Standard deviation

        // Generate data and bin it
        const rawData = generateNormalData(1000, mean, stdDev, minValue, maxValue);
        const histogramData = Array(binCount).fill(0);

        // Bin the data
        const binWidth = (maxValue - minValue) / binCount;
        for (let i = 0; i < rawData.length; i++) {
            const value = rawData[i];
            const binIndex = Math.floor((value - minValue) / binWidth);
            histogramData[Math.min(binIndex, binCount - 1)]++;
        }

        // Draw Histogram function
        function drawHistogram(minPrice, maxPrice) {
            // Clear the canvas
            ctx.clearRect(0, 0, priceHistogramCanvas.width, priceHistogramCanvas.height);

            // Determine the maximum height of the bars
            const maxBarHeight = priceHistogramCanvas.height;

            // Draw bars
            const barWidth = priceHistogramCanvas.width / histogramData.length;
            const maxDataValue = Math.max(...histogramData);
            const heightScale = maxBarHeight / maxDataValue;

            for (let i = 0; i < histogramData.length; i++) {
                const barHeight = histogramData[i] * heightScale; // Scale bar height to canvas height
                const x = i * barWidth;
                const y = priceHistogramCanvas.height - barHeight;

                // Highlight the bars within the selected price range
                const binLow = minValue + (i * (maxValue - minValue) / binCount);
                const binHigh = minValue + ((i + 1) * (maxValue - minValue) / binCount);
                if (binHigh >= minPrice && binLow <= maxPrice) {
                    ctx.fillStyle = '#292C2D'; // Color for bars within range
                } else {
                    ctx.fillStyle = '#ddd'; // Gray color for bars outside range
                }

                ctx.fillRect(x, y, barWidth - 1, barHeight); // Draw bar with full height
            }
        }



        // Update the histogram when slider or inputs change
        function updateHistogram() {
            const minPrice = parseInt(priceSlider.noUiSlider.get()[0]);
            const maxPrice = parseInt(priceSlider.noUiSlider.get()[1]);

            // Update inputs
            document.getElementById('minPriceInput').value = minPrice;
            document.getElementById('maxPriceInput').value = maxPrice;

            drawHistogram(minPrice, maxPrice);
        }

        // Attach event listener to slider
        priceSlider.noUiSlider.on('update', updateHistogram);

        // Attach event listeners to inputs
        document.getElementById('minPriceInput').addEventListener('input', function () {
            const minPrice = parseInt(this.value);
            const maxPrice = parseInt(document.getElementById('maxPriceInput').value);

            if (minPrice < maxPrice) {
                priceSlider.noUiSlider.set([minPrice, maxPrice]);
            }
        });

        document.getElementById('maxPriceInput').addEventListener('input', function () {
            const maxPrice = parseInt(this.value);
            const minPrice = parseInt(document.getElementById('minPriceInput').value);

            if (minPrice < maxPrice) {
                priceSlider.noUiSlider.set([minPrice, maxPrice]);
            }
        });

        // Initial render
        updateHistogram();

    </script>
    <script src="/libs/Bootstrap/bootstrap.bundle.min.js"></script>
    <script src="/js/Priceslider/pirceSlider.js"></script>

</body>

</html>